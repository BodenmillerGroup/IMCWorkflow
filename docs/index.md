---
hide:
  - toc
---

# A guide to IMC data analysis

This repository collects tools for imaging mass cytometry (IMC) data analysis. 
Common analysis steps include [image processing](process.md), [image visualization](viewers.md) and [downstream analysis](analysis.md).

## Introduction

Imaging mass cytometry is a highly-multiplexed imaging technology that measures the expression of up to 40 proteins or RNA molecules (also refered to as markers) in tissues[^fn1].
For more information on imaging mass cytometry, please refer to the more extended [Introduction](intro.md).

## Image processing

Upon image acquisition, raw data are stored in the proprietary `.mcd` format, which contain experiment-specific metadata, one or multiple multi-channel images (one per acquisition) and the generated panoramas (see [Introduction](intro.md)).
The first step of the pre-processing pipeline includes the conversion of images from `.mcd` to `.ome.tiff` and `.tiff` format, which is supported by most image analysis software.

Cell segmentation is performed using pixel-classification or deep learning based approaches outlined in [Image processing](process.md). 
After cell segmnetation, intensity features representing marker abundance and morphological features are extracted and exported. 

These IMC image processing approaches are implemented in the [IMC Segmentation pipeline](https://github.com/BodenmillerGroup/ImcSegmentationPipeline) and the [steinbock](https://github.com/BodenmillerGroup/steinbock) framework.

For more details see [Image processing](prepro.md).

## Interactive image visualization

Raw `.mcd` files can be interactively visualized using the [MCD Viewer](https://www.fluidigm.com/software) software distributed by Fluidigm<sup>&reg;</sup>.

The [histoCAT](https://bodenmillergroup.github.io/histoCAT/) toolbox supports interactive image and data visualization, clustering and spatial data analysis for data generated by IMC. 
The [histoCAT-web](https://github.com/BodenmillerGroup/histocat-web) webapp supports browser-based analysis directly on raw IMC data.

The [napari-imc](https://github.com/BodenmillerGroup/napari-imc) plugin for [napari](https://napari.org/) allows joint visualization of multichannel IMC images and panoramas in a shared cooridnate system.

The full features of the viewers can be seen at [Image visualization](viewers.md).

## Downstream analysis

The  extracted single-cell features can be read into `R` using the [imcRtools](https://bioconductor.org/packages/imcRtools) package. 
Spatially annotated single-cell data is stored in a [SingleCellExperiment](https://bioconductor.org/packages/SingleCellExperiment) or [SpatialExperiment](https://bioconductor.org/packages/SpatialExperiment) container.
The [Orchestrating Single-Cell Analysis with Bioconductor](https://bioconductor.org/books/release/OSCA/) book offers a great resource to perform single-cell data analysis including dimensionality reduction, clustering and data visualization based on the `SingleCellExperiment` container.
As part of the Bioconductor project, the [imcRtools](https://bioconductor.org/packages/imcRtools) package supports a variety of spatial data analysis approaches.

To get an overview on common analysis steps, please refer to [Downstream analysis](analysis.md).

## Contributors

Nils Eling [:fontawesome-brands-github:](https://github.com/nilseling) [:fontawesome-brands-twitter:](https://twitter.com/NilsEling) [:fontawesome-solid-home:](https://nilseling.github.io/)

Jonas Windhager [:fontawesome-brands-github:](https://github.com/jwindhager) [:fontawesome-brands-twitter:](https://twitter.com/JonasWindhager)

## Publication

!!! quote ""
    
    Windhager J, Bodenmiller B, Eling N (2021). An end-to-end workflow for multiplexed image processing and analysis. bioRxiv. doi: https://doi.org/10.1101/2021.11.12.468357.

[^fn1]: Giesen C. _et al._ (2014) Highly multiplexed imaging of tumor tissues with subcellular resolution by mass cytometry. Nat. Methods, 11, 417â€“422.